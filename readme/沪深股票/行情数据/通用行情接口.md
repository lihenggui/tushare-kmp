# 通用行情接口

## 接口名称：`pro_bar`

## 接口说明
- **集成开发接口**，支持 **股票（未复权、前复权、后复权）、指数、数字货币、ETF基金、期货、期权** 等行情数据。
- **支持分钟数据**（需 600 积分试用，正式权限请参考权限列表）。
- **部分指标为现用现算**，不同数据类型对应不同的积分要求，具体请参阅各类数据的文档说明。
- **更新时间**：
  - **股票 & 指数**：通常在 **15:00 - 17:00** 之间更新。
  - **数字货币**：实时更新。

## **特别说明**
- **本接口为 SDK 集成接口**，暂不支持 **HTTP 方式调用**。
- **复权机制**：
  - 仅支持 **日线复权**。
  - **复权方式**：采用 **分红再投模式**，复权数据会根据 `end_date` 动态调整。
  - 若需获取与行情软件一致的复权数据，请参考 **股票技术因子接口**。

---

## **输入参数**

| 名称        | 类型  | 必选 | 描述 |
|------------|------|------|------------------------------|
| ts_code    | str  | Y    | 证券代码（**不支持多值输入**，多值输入会导致重复记录） |
| start_date | str  | N    | 开始日期（**日线格式：YYYYMMDD**，**分钟数据格式：YYYY-MM-DD HH:MM:SS**） |
| end_date   | str  | N    | 结束日期（**日线格式：YYYYMMDD**） |
| asset      | str  | Y    | 资产类别（`E` - 股票，`I` - 指数，`C` - 数字货币，`FT` - 期货，`FD` - 基金，`O` - 期权，`CB` - 可转债） |
| adj        | str  | N    | 复权类型（仅适用于股票）：`None` - 未复权，`qfq` - 前复权，`hfq` - 后复权（默认 `None`） |
| freq       | str  | Y    | 数据频度（`min` - 分钟，`D` - 日，`W` - 周，`M` - 月） |
| ma         | list | N    | 均线（支持任意 `int` 数值，如 `[5, 20, 50]`） |
| factors    | list | N    | 股票因子（仅 `asset='E'` 有效）：`tor` - 换手率，`vr` - 量比 |
| adjfactor  | str  | N    | 是否返回复权因子（`True` - 返回，`False` - 不返回，默认 `False`） |

---

## **输出参数**
- **具体输出指标** 请参考各类行情数据文档：
  - **[股票 Daily](https://tushare.pro/document/2?doc_id=27)**
  - **[基金 Daily](https://tushare.pro/document/2?doc_id=127)**
  - **[期货 Daily](https://tushare.pro/document/2?doc_id=138)**
  - **[期权 Daily](https://tushare.pro/document/2?doc_id=159)**
  - **[指数 Daily](https://tushare.pro/document/2?doc_id=95)**

---

## **接口示例**

### **获取股票前复权行情**
```python
import tushare as ts

# 设置 Tushare Token（请在 Tushare 个人中心获取）
ts.set_token('你的token')

# 获取 000001.SZ（平安银行）的前复权行情
df = ts.pro_bar(ts_code='000001.SZ', adj='qfq', start_date='20180101', end_date='20181011')
```

#### **示例数据**
| ts_code   | trade_date | open   | high   | low    | close  |
|-----------|-----------|--------|--------|--------|--------|
| 000001.SZ | 20181011  | 1085.71 | 1097.59 | 1047.90 | 1065.19 |
| 000001.SZ | 20181010  | 1138.65 | 1151.61 | 1121.36 | 1128.92 |
| 000001.SZ | 20181009  | 1130.00 | 1155.93 | 1122.44 | 1140.81 |
| 000001.SZ | 20181008  | 1155.93 | 1165.65 | 1128.92 | 1128.92 |
| 000001.SZ | 20180928  | 1164.57 | 1217.51 | 1164.57 | 1193.74 |

---

### **获取上证指数行情**
```python
# 获取 000001.SH（上证指数）的行情数据
df = ts.pro_bar(ts_code='000001.SH', asset='I', start_date='20180101', end_date='20181011')
```

#### **示例数据**
| ts_code   | trade_date | close   | open   | high   | low    | pre_close | change  | pct_chg | vol        | amount      |
|-----------|-----------|---------|--------|--------|--------|-----------|---------|---------|------------|-------------|
| 000001.SH | 20181011  | 2583.46 | 2643.07 | 2661.29 | 2560.32 | 2725.84   | -142.38 | -5.22   | 197150702  | 170057762.5 |
| 000001.SH | 20181010  | 2725.84 | 2723.72 | 2743.55 | 2703.06 | 2721.01   | 4.82    | 0.18    | 113485736  | 111312455.3 |
| 000001.SH | 20181009  | 2721.01 | 2713.73 | 2734.31 | 2711.20 | 2716.51   | 4.50    | 0.17    | 116771899  | 110292457.8 |

---

### **获取均线数据**
```python
# 获取 000001.SZ（平安银行）的 5 日、20 日、50 日均线
df = ts.pro_bar(ts_code='000001.SZ', start_date='20180101', end_date='20181011', ma=[5, 20, 50])
```
> **注意**：均线数据是 **动态计算**，必须 **设置 `start_date` 早于最大均线天数**，然后自行截取所需日期范围。

---

### **获取换手率（tor）、量比（vr）**
```python
# 获取 000001.SZ（平安银行）的换手率和量比
df = ts.pro_bar(ts_code='000001.SZ', start_date='20180101', end_date='20181011', factors=['tor', 'vr'])
```

---

## **说明**
- **如果已通过 `ts.set_token('xxxx')` 设置 Token**，则 `pro_api` 参数 **不是必需的**。
- **示例**：
  ```python
  df = ts.pro_bar(ts_code='000001.SH', asset='I', start_date='20180101', end_date='20181011')
  ```
